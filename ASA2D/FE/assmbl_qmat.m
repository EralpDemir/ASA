function [Cr,Cc,Cv,cc] = assmbl_qmat(iele,nnpe,numgdof,np,np_RefPoints,ce,Cr,Cc,Cv,cc)% assembles elemental force and stiffness matrices into global counterparts% nnpe2=2*nnpe;for  i=1:1:nnpe		% Global dof    I3=3*np(iele,i);    I2=I3-1;    I1=I2-1;    % Local dof    i3=3*i;    i2=i3-1;    i1=i2-1;	  	     for j=1:1:nnpe	           % Global dof        J3=3*np_RefPoints(j);          J2=J3-1;	          J1=J2-1;              % Local dof        j3=j*3;        j2=j3-1;        j1=j2-1;               Cr(cc)=I1;         Cc(cc)=J1;         Cv(cc)=ce(i1,j1);        cc=cc+1;        Cr(cc)=I1;         Cc(cc)=J2;         Cv(cc)=ce(i1,j2);         cc=cc+1;        Cr(cc)=I1;         Cc(cc)=J3;         Cv(cc)=ce(i1,j3);         cc=cc+1;                Cr(cc)=I2;         Cc(cc)=J1;        Cv(cc)=ce(i2,j1);          cc=cc+1;        Cr(cc)=I2;         Cc(cc)=J2;         Cv(cc)=ce(i2,j2);         cc=cc+1;        Cr(cc)=I2;         Cc(cc)=J3;         Cv(cc)=ce(i2,j3);         cc=cc+1;                Cr(cc)=I3;         Cc(cc)=J1;        Cv(cc)=ce(i3,j1);          cc=cc+1;        Cr(cc)=I3;         Cc(cc)=J2;         Cv(cc)=ce(i3,j2);         cc=cc+1;        Cr(cc)=I3;         Cc(cc)=J3;         Cv(cc)=ce(i3,j3);         cc=cc+1;           endendreturnend