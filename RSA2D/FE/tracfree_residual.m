function kes =tracfree_residual(nnps,nqpts,swt,bigNsurf,r,rjs,beta)% computes surface forces for traction loadingiend=3*nnps; kes= zeros(iend,iend);bigNsqp= zeros(3,iend);TMAT = zeros(2,iend);for j=1:1:nqpts  	    % Surface normals    n1=r(1,j);    n2=r(2,j);        % At each quad point (3x12)    bigNsqp(:,:) = bigNsurf(:,:,j);            % Coefficient matrix (2x3)    B=[ n1, 0, n2;        0, n2, n1];            % Coefficient matrix for in-plane tractions (3x3)    A=[ 1-(n1*n1), -n1*n2;        -n2*n1, 1-(n2*n2);];        T = A * B;        % Constants (weight x jacobian)    xkfac = swt(j) * rjs(j);    % Stiffness at the quad point    kesqp = beta * xkfac * (bigNsqp' * T' * T * bigNsqp);        % Total stiffness    kes = kes + kesqp;        % Traction mapping    TMAT = TMAT + T * bigNsqp;end